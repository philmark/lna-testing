<html>
    <head>
    </head>
    <body>
        <button onclick="fetch()">
            Trigger query
        </button>

        <script>
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js', { scope: './' }).then(reg => {
                    console.log('Service Worker registered with scope:', reg.scope);
                }).catch(err => {
                    console.log('Service Worker registration failed:', err);
                });
            }

            async function getLNAState() {
                try {
                    const permission = await navigator.permissions.query({ name: 'local-network-access' });
                    let lnaPermission = permission?.state || 'unknown';
                    permission.onchange = () => {
                        console.log('LNA state changed to:', permission.state);
                        lnaPermission = permission.state;

                        const lnaStateElement = document.querySelector('.lnaState');
                        lnaStateElement.textContent = `LNA State: ${lnaPermission}`;
                    };
                } catch (error) {
                    console.error('Error querying LNA permission:', error);
                }
            }

            window.addEventListener('load', async () => {
                getLNAState();
            });

            function fetch() {
                return fetch('http://localhost:8000')
                    .then((response) => {
                        appendResult(url, `response received`);
                    })
                    .catch((error) => {
                        appendResult(url, `error = ${error}`);
                    });
            }
        </script>
    </body>
</html>